<!-- templates/index.html -->
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Consultor del Clima</title>
    <link rel="stylesheet" href="estilos.css">

</head>
<body>
    <h1>üå§Ô∏è Consultor del Clima</h1>
    <form id="form-clima">
        <label for="ciudad">Nombre de la ciudad:</label><br />
        <input type="text" id="ciudad" name="ciudad" placeholder="Ej: Buenos Aires" required />
        <button type="submit">Consultar clima</button>
    </form>
    <pre id="resultado"></pre>

    <script>
        const form = document.getElementById("form-clima");
        const resultado = document.getElementById("resultado");

        form.addEventListener("submit", async (e) => {
            e.preventDefault();
            resultado.textContent = "‚è≥ Consultando clima‚Ä¶";

            // Prueba fija para verificar el DOM:
            // resultado.textContent = "‚úÖ El listener funciona";
            // return;

            const ciudad = form.ciudad.value.trim();
            console.log("Ciudad ingresada:", ciudad);

            try {
                const response = await fetch(`/clima_actual?ciudad=${encodeURIComponent(ciudad)}`);
                console.log("Fetch status:", response.status);
                const data = await response.json();
                console.log("Datos recibidos:", data);

                if (!response.ok) {
                    resultado.textContent = `‚ùå Error: ${data.error || response.statusText}`;
                } else if (data.error) {
                    resultado.textContent = `‚ùå ${data.error}`;
                } else {
                    resultado.textContent = data.resultado;
                }
            } catch (error) {
                console.error("Error en fetch:", error);
                resultado.textContent = `‚ùå Error de conexi√≥n: ${error.message}`;
            }
        });
    </script>
</body>
</html>
